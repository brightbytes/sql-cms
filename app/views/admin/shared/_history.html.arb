panel "History" do
  versions = resource.versions
  unless versions.empty?
    table_for(versions) do
      column("#") { |v| "#{versions.index(v) + 1}." }
      column(:event) { |v| v.event.titleize }
      column(:changeset) { |v| code(pretty_print_as_json(v.changeset)) }
      column("Modified at") { |v| v.created_at.localtime.to_s }
      column("Modified by") do |v|
        if v.user_id
          if u = User.find_by_id(v.user_id)
            link_to(u.full_name, user_path(u))
          else
            "**Deleted**"
          end
        else
          "Script or Job"
        end
      end
      column("Version ID", &:id)
    end
  end
end
